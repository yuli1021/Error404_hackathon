<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot con Dialogflow</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Sidebar 
    <div class="sidebar-trigger"></div>
    <div class="sidebar">
      <a class="active" href="#home" title="Inicio">
        <i class="fa fa-home"></i>
        <span>Home</span>
      </a>
      <a href="#news" title="Noticias">
        <i class="fa fa-newspaper"></i>
        <span>News</span>
      </a>
      <a href="#contact" title="Contáctanos">
        <i class="fa fa-phone"></i>
        <span>Contact</span>
      </a>
      <a href="#about" title="Acerca de">
        <i class="fa fa-info-circle"></i>
        <span>About</span>
      </a>
    </div>
    <div class="sidebar-icon">☰</div>
-->
    <div class="content">
        <div class="content">
  <div class="main-layout">
    <!-- Sección izquierda: Información del asistente -->
    <aside class="assistant-info">
      <img src="utc.jpg" alt="Logo Universidad Tecnológica de Coahuila" class="utc-logo">
      <h2>Asistente Virtual U.T. de Coahuila</h2>
      <p>
        Bienvenido al asistente virtual de la Universidad Tecnológica de Coahuila.  
        Este sistema está diseñado para ayudarte con:
      </p>
      <ul>
        <li>Información sobre carreras y planes de estudio</li>
        <li>Horarios y servicios escolares</li>
        <li>Asistencia con procesos administrativos</li>
        <li>Dudas sobre inscripción y becas</li>
        <li>Guía para el uso de plataformas institucionales</li>
      </ul>
      <p>
        Solo escribe tu duda en el chat y obtén una respuesta al instante.
      </p>
    </aside>

    <!-- Contenido principal -->
   <div class="chat-container">
            <div class="chat-box" id="chat-box">
                <div class="message bot">
                    <p>Hola, soy el chatbot. ¿En qué puedo ayudarte, pedazo de genio?</p>
                </div>
            </div>

            <div class="chat-input">
                <input type="text" id="mensaje" placeholder="Escribe tu mensaje aquí..." />
                <button class="send-btn" onclick="enviar()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

   <script>

// ACTIVAR ENVÍO CON ENTER
document.getElementById('mensaje').addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        enviar();
    }
});

function enviar() {
    const input = document.getElementById('mensaje');
    const texto = input.value.trim();
    if (!texto) return;

    const chatBox = document.getElementById('chat-box');

    // Mensaje del usuario
    const userMsg = document.createElement('div');
    userMsg.className = 'message user';
    userMsg.innerHTML = `<p>${texto}</p>`;
    chatBox.appendChild(userMsg);

    // Limpiar y enfocar
    input.value = '';
    input.focus();

    // Petición a api.php
    fetch('api.php', {
        method: 'POST',
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ mensaje: texto })
    })
    .then(res => res.json())
    .then(data => {
        const botMsg = document.createElement('div');
        botMsg.className = 'message bot';

        const respuesta =
            (data.respuesta && data.respuesta.trim() !== "")
            ? data.respuesta
            : data.error
              ? data.error
              : "Sin respuesta del servidor.";

        botMsg.innerHTML = `<p>${respuesta}</p>`;
        chatBox.appendChild(botMsg);
        chatBox.scrollTop = chatBox.scrollHeight;
    })
    .catch(err => {
        console.error("FETCH ERROR:", err);
        const botMsg = document.createElement('div');
        botMsg.className = 'message bot';
        botMsg.innerHTML = `<p>Error de conexión con el servidor.</p>`;
        chatBox.appendChild(botMsg);
        chatBox.scrollTop = chatBox.scrollHeight;
    });
}

</script>

    
</body>
</html>
